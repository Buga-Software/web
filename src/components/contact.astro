---
const formAction = import.meta.env.VITE_FORMSPREE_URL;
---

<section class="flex flex-col gap-10 mb-10 lg:mb-40 justify-center items-center w-full px-4">
  <div class="text-center space-y-3 max-w-2xl">
    <h2 class="text-4xl md:text-5xl font-bold leading-tight text-white">
      No dudes en contactarnos
    </h2>
    <p class="text-gray-300 opacity-90 text-lg md:text-xl">
      Cada proyecto exitoso inicia con una conversación
    </p>
  </div>

  <div class="w-full max-w-3xl">
    <form
      id="contact-form"
      action={formAction}
      method="POST"
      class="flex flex-col gap-5 bg-[#0f0f0f]/60 p-6 md:p-8 rounded-2xl shadow-lg border border-white/10 backdrop-blur-md"
    >
      <div class="flex flex-col">
        <label class="mb-1 text-sm font-medium text-gray-300">Nombre o Razón Social</label>
        <input
          type="text"
          name="from_name"
          placeholder="Ej. Juan Pérez"
          required
          class="px-4 py-3 bg-black/30 text-white border border-white/20 rounded-xl focus:outline-none focus:ring-2 focus:ring-white placeholder-white/30"
        />
      </div>

      <div class="flex flex-col">
        <label class="mb-1 text-sm font-medium text-gray-300">Correo</label>
        <input
          type="email"
          name="reply_to"
          placeholder="ejemplo@email.com"
          required
          class="px-4 py-3 bg-black/30 text-white border border-white/20 rounded-xl focus:outline-none focus:ring-2 focus:ring-white placeholder-white/30"
        />
      </div>

      <div class="flex flex-col">
        <label class="mb-1 text-sm font-medium text-gray-300">Tu propuesta o pregunta</label>
        <textarea
          name="message"
          placeholder="Cuéntanos sobre tu idea"
          rows="5"
          required
          class="px-4 py-3 bg-black/30 text-white border border-white/20 rounded-xl focus:outline-none focus:ring-2 focus:ring-white placeholder-white/30 resize-none"
        ></textarea>
      </div>

      <button
        type="submit"
        class="px-6 py-3 bg-white/5 text-white border border-white/1 font-semibold rounded-xl shadow-md transition-all hover:bg-white/10 hover:shadow-lg cursor-pointer focus:outline-none focus:ring-2 focus:ring-[var(--sec)]"
      >
        Enviar mensaje
      </button>
    </form>

    <div
      id="form-message"
      class="hidden justify-center items-center mt-4 text-[var(--white)] text-lg"
    >
      ✅ ¡Gracias por tu mensaje!
    </div>
  </div>
</section>

<script type="module" is:inline>
  const form = document.getElementById("contact-form");
  const formMessage = document.getElementById("form-message");

  form.addEventListener("submit", async (e) => {
    e.preventDefault();
    const formData = new FormData(form);

    try {
      const response = await fetch(form.action, {
        method: "POST",
        body: formData,
        headers: { Accept: "application/json" },
      });
      if (response.ok) {
        form.reset();
        form.style.display = "none";
        formMessage.classList.remove("hidden");
      } else {
        const data = await response.json();
        console.error("Error response:", data);
        alert("There was a problem sending your message.");
      }
    } catch (error) {
      console.error("Error:", error);
      alert("There was a problem sending your message.");
    }
  });
</script>